# 定义应用环境
## Web 威胁
1. 缓冲区溢出：攻击者试图将足够多的数据发送到输入缓冲区中，以便让应用程序或输出缓冲区溢出，从而导致在缓冲区外的内存数据被损坏。某些形式的缓冲区溢出能使攻击者执行看起来不可能完成的任务，因为受影响的内存中保存着可执行的代码。解决这种问题最好的办法是，对应用程序处理的所有数据都执行边界和大小检查，无论是输入还是输出。
2. 代码注入：一个实体以中间人攻击（man-in-the-middle-attack）的形式将代码添加到服务器和客户端（如浏览器）之间的数据流中。被攻击方经常会将这种注入代码视为原始页面的一部分，但它可能包含任何东西。当然，被攻击方甚至看不到这些注入的代码。它可能潜伏在后台，随时准备给应用程序制造各种各样的问题。解决该攻击的一种好方法是确保使用了加密的数据流、HTTPS 协议和代码验证（如果可能）。提供客户端反馈机制也是一个好主意。
	1. 代码注入其实很频繁，比如无耻的ISP（互联网服务提供商）将JavaScript代码注入到数据流中以便页面上放置广告。
3. 跨站脚本（XSS）：攻击者将 JavaScript 脚本或其他可执行代码注入到应用程序的输出流中。接收者会将你的应用程序看作感染源，但其实它并不是。大多数时候，不应该在没有严格验证的情况下允许用户通过你的应用程序直接将数据发送给其他用户。对于像博客这样的应用程序来说，采取审核机制是很有必要的，以此确保你的应用程序最终不会沦为病毒的宿主，或者出现更糟糕的情况：被掺入看似无害的数据。
5. 文件上传：尽可能验证文件。不要单纯依赖文件扩展名进行排除，黑客经常会将一个文件伪装成另一种类型来绕过服务器的安全验证。
6. 硬编码的认证：出于测试目的，开发人员经常将认证信息放在应用程序的初始化文件中。我们需要去掉这些硬编码的认证信息，以集中式存储的安全信息替代。将数据存储在安全的位置而不是 Web 应用服务器上是很重要的，这样黑客就不能轻易地查看到可用于访问应用程序的凭据。如果你的应用程序确实需要一些初始化文件，那么要确保这些文件放在 Web 根目录以外的地方，以防止黑客偶然发现它们。
7. 发现隐藏或受限制的文件 / 目录：当应用程序允许输入一些特殊字符（比如斜杠或反斜杠）时，黑客就有可能发现隐藏或受限制的文件和目录。这些地方可能包含各种有助于黑客攻击你的系统的信息。尽可能禁止使用特殊字符是一个很好的主意。除此之外，请把重要的文件放在 Web 根目录之外且操作系统能直接控制的地方。
8. 缺少认证或认证不正确：应该避免因为任何原因而使用访客账户，并为每一个用户分配独立的账户。
9. 缺少授权或者授权不正确：只为用户提供执行特定任务时所需要的权限。
11. 缺少加密或者加密不正确：使用加密技术在两个终端之间传输数据可以防止黑客监听通信。
12. 操作系统命令注入：攻击者会修改应用程序使用的操作系统命令来执行特定的任务。你的 Web 应用程序一开始可能就不应该使用系统调用。但是，如果必须使用，请确保你的应用程序在一个沙盒环境中运行。
13. 参数篡改：黑客会对作为请求头或 URL 一部分的参数进行尝试。
14. 远程代码包含：如今的很多 Web 应用程序依赖包含外部库、框架和 API。大多数情况下，包含语句会含有一个相对路径或者使用一个记录着硬编码路径的变量，这样做是为了方便以后更换远程代码的位置。当黑客能够获取到这些路径信息并更改它们的时候，远程代码包含就可能被指向黑客想要包含的任何代码，从而使得黑客可以完全掌控你的系统。避免这种问题的最佳方法就是尽量使用硬编码的完整路径，尽管这会使代码维护变得困难。
15. 会话劫持：每次用户登录到你的 Web 服务器，服务器就会为其创建一个唯一的会话。会话劫持者会侵入到会话中并拦截用户与服务器之间传输的数据。含有劫持会话所需信息的三个最常见的地方是：cookie、URL 重写和隐藏域。黑客会在这些地方查找会话信息。
16. SQL 注入：攻击者会修改由应用程序创建的查询，而这个查询是由用户或其他输入引起的。大部分 SQL 注入的情况是，应用程序需要的是用于查询的数据，但它实际接收到的却是一些 SQL 片段。其他形式的 SQL 注入攻击与使用了转义字符或其他意想不到的字符或字符串有关。一个避免 SQL 注入攻击的好办法是避免动态查询。
## 软件安全保障
软件安全保障（Software Security Assurance，SSA）的观点是，软件需要某种监管来确保它不会导致其使用、控制和保护的数据及资源发生丢失、误差、篡改、不可用或误用。
### OSSAP
开放 Web 应用安全项目（Open Web Application Security Project，OWASP）
### SSA的要求
1. 评估软件和制定修复计划
2. 定义数据的各种安全风险并进行分类，优先需要修复最严重的风险
3. 执行全面的代码检查
4. 进行必要的更改
5. 测试修复并在生产环境中验证它们确实是有效的
6. 制定防御机制来保护应用程序的访问及其管理的数据
7. 衡量你所在的这些更改的有效性
8. 以适当的方式培训管理者、用户和开发人员，以确保良好的应用安全性。

==另一种SSA策略==
1. 把安全性要求置于产品需求之上（这一条只需要在启动新软件开发时执行）。
2. 定义并与开发人员沟通写代码时必须遵守的安全编码规范。
3. 开发人员在写新代码时要启用自动代码检查。
4. 完成应用开发之后要执行全面的代码检查。
5. 对整个应用程序进行渗透测试和脆弱性评估。
6. 评估测试结果以找到安全和业务之间的平衡点。制订计划，修复已确定的、对业务有很大危害的漏洞。
7. 执行所有需要进行的安全性修复。
8. 重复步骤 (5)。

### 对数据和资源分类
### 进行必要的分析
作为 SSA 的一部分，你需要对应用程序进行分析（包括威胁建模、用户界面漏洞和数据展示漏洞）。
1. 逻辑
2. 数据
	1. 谁能访问数据
	2. 数据以什么格式存储
	3. 数据何时可被访问
	4. 数据存储在什么地方
	5. 为什么每个数据项都能作为应用程序的一部分被使用
	6. 数据如何分解成各个部分，以及组合数据供应用程序使用的后果
3. 界面
	1. 功能膨胀
	2. 提示界面
4. ==约束==
	1. 确保数据有正确的类型
	2. 定义数据能接受的值的范围
	3. 明确数据长度的最大和最小值
	4. 列出所有不能接受的数据值
## 与语言相关的问题
### HTML
- 代码注入
- 用户追踪
- 污染输入
	- 你可能只需要一个数字型的值，但用户可能输入一段脚本代码。尝试对输入进行彻底检测以确保真正得到你要求的输入数据，这在客户端近乎是不可能的，所以你还需要确保有强大的服务器端检查机制。
